events { worker_connections 1024; }   # Max concurrent connections Nginx can handle

http {
    include       /etc/nginx/mime.types;   # File type mappings (html, css, js, etc.)
    default_type  application/octet-stream; # Default type if unknown

    # Enable gzip compression for performance
    gzip on;
    gzip_types text/plain text/css application/javascript application/json;

    server {
        listen 80;                         # Listen on port 80 (inside container)
        server_name localhost;             # Server name (domain/hostname)
        root /usr/share/nginx/html;        # Where app files are stored
        index weather.html index.html;     # Default page if no file specified

        location / {                       # Root URL ("/")
            try_files $uri $uri/ /weather.html;  # Serve file or fallback to weather.html
        }

        # Serve static assets (css, js, images) with cache
        location ~* \.(css|js|png|jpg|jpeg|gif|ico|svg)$ {
            add_header Cache-Control "public, max-age=31536000";  # Cache for 1 year
            try_files $uri =404;                                 # Return 404 if missing
        }

        # Security headers
        add_header X-Frame-Options "SAMEORIGIN" always;   # Prevent clickjacking
        add_header X-Content-Type-Options "nosniff" always; # Prevent MIME sniffing
        add_header X-XSS-Protection "1; mode=block" always; # Basic XSS protection
    }
}
